<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:include="include :: header"></head>
<body class="hold-transition skin-blue sidebar-mini">
<!-- Content Header (Page header) -->
<section class="content-header">
  <h1>
    编辑权限
    <small>Create Permission</small>
  </h1>
</section>
<!-- Main content -->
<section class="content">
  <div class="row">
    <div class="col-xs-12">
      <div class="box">
        <div class="box-header">
          <h3>权限基本信息</h3>
        </div>
        <form id="permissionForm" class="form-horizontal">
          <input type="hidden" name="id" th:value="${permission.id}">
          <div class="box-body">
            <div class="form-group">
              <label for="permissionName" class="col-sm-2 control-label">权限名</label>
              <div class="col-sm-10">
                <input type="text" class="form-control" id="permissionName" name="permissionName"
                       th:value="${permission.permissionName}" placeholder="权限名" >
              </div>
            </div>
            <div class="form-group">
              <label for="url" class="col-sm-2 control-label">Url</label>
              <div class="col-sm-10">
                <input type="text" class="form-control" id="url" name="url" th:value="${permission.url}"
                       placeholder="资源地址">
              </div>
            </div>
            <div class="form-group">
              <label for="description" class="col-sm-2 control-label">描述</label>
              <div class="col-sm-10">
                <input type="text" class="form-control" id="description" name="description"
                       th:value="${permission.description}" placeholder="描述">
              </div>
            </div>
            <div class="form-group">
              <label for="orderNo" class="col-sm-2 control-label">分组排序</label>
              <div class="col-sm-10">
                <input type="text" class="form-control" id="orderNo" name="orderNo"
                       th:value="${permission.orderNo}" placeholder="请输入分组排序">
              </div>
            </div>
          </div>

          <div class="box-footer">
            <button type="button" id="btn_create" class="btn btn-info pull-right">提交</button>
          </div>
          <!-- /.box-footer -->
        </form>
      </div>
      <!-- /.box -->
    </div>
    <!-- /.col -->
  </div>
  <!-- /.row -->
</section>
<!-- /.content -->
<div th:include="include :: footer"></div>

<script>

  var permissionForm = $("#permissionForm");

  /** 表单验证设置 */
  /*function setValid() {
    permissionForm.bootstrapValidator({
      feedbackIcons: {
        valid: 'glyphicon glyphicon-ok',
        invalid: 'glyphicon glyphicon-remove',
        validating: 'glyphicon glyphicon-refresh'
      },
      fields: {
        permissionName: {
          validators: {
            notEmpty: {message: '请输入权限名'},
            remote: {
              url: "/sys/permission/checkPermissionNameUnique",
              message: '资源已存在',
              delay: 200,
              type: 'POST',
              data: {userName: $("#permissionName").val()}
            }
          }
        },
        url: {validators: {notEmpty: {message: '请输入url'}}},
        description: {validators: {notEmpty: {message: '请输入描述'}}}
      }
    });
  }*/

  /** 创建项目事件 */
  function createEvent() {
    $("#btn_create").click(function () {
      permissionForm.bootstrapValidator('validate');//提交验证
      if (permissionForm.data('bootstrapValidator').isValid()) {//获取验证结果，如果成功，执行下面代码
        $.ajax({
          url: "/sys/permission/update",
          type: "POST",
          data: permissionForm.serialize(),
          success: function (result) {
            if (result.status === 200) {
              toastr.success("编辑成功！");
              //重新加载数据
              location.href = "/sys/permissions";
            } else {
              toastr.error("编辑失败！");
            }
          },
          error: function () {
            toastr.error("系统错误，编辑失败！");
          }
        });
      }
    });
  }

  $(function () {
    // setValid();
    createEvent();
  });

</script>
</body>
</html>
